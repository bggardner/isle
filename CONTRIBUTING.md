# Framework
ISLE roughly follows the [Model-View-Controller](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller) design pattern.

## Model
* Settings: `www/includes/settings.php` (generated by the setup wizard)
* Images and attachments: `www/uploads`
* User session data: PHP `$_SESSION` variable
* All other data: MySQL database tables

## Views
* Location: `www/includes/views`
* Views do not modify the Model, except for clearing `$_SESSION['message']`
* Contain mostly HTML
* Helper class: `www/includes/classes/ViewUtility.php`

## Controllers
* Internal: `www/includes/`
    * Setup Wizard: `setup.php`
    * Configuration: `config.php`
    * Error Handling: `error.php`
    * Authentication/Authorization: `auth.php`
    * Settings: `classes/Settings.php`
    * Database and File Management: `classes/Service.php`
        * Includes default user authentication method
* Synchronous: `www/[page].php`
    * Displays whole-page Views
    * Directs Node add/edit/delete to Service methods
* Asynchronous: `www/ajax.php`
    * Returns JSON data and dialog/modal views
    * Manages cart contents
    * Receives file uploads (processed in `ISLE\Service`)
    * Autocomplete (processed in `ISLE\ViewUtility`)

# Style Guide

## Overall
* All data views must be accessible by unique URL (no JS-only manipulation)
* Modal dialogs to be loaded by JS fetch()
* Spaces, not tabs, for indenting

## JavaScript
* https://google.github.io/styleguide/jsguide.html
* No compilation/preprocessors (RequireJS)
* Single file for customizations (main.js)
* No jQuery, minimal remote utilities
* Documentation: JSDoc

## HTML/CSS
* https://google.github.io/styleguide/htmlcssguide.html
* No CSS preprocessors (Less/Sass)
* Single file for customizations (main.css)
* Use Bootstrap 5 styling and components whenever possible (minimal customizations)
    * Table row/column styling is acceptable in main.css
* Use Bootstrap Icons for icons whenever possible

## PHP
* https://www.php-fig.org/psr/psr-12/
* Use the short-echo tags (<?= ?>) for in-line code, otherwise use long tags (<?php ?>) on separate lines at column 0
* Use single-quoted strings unless string contains only or excessive single quotes or escape sequences
* Use strings as array keys when appropriate
* Use the `ISLE` namespace for custom classes
* Avoid using `use` for imports, use absolute path instead for clarity
* Avoid using globally-scoped variables in multiple files (pretend each file is locally-scoped) with exceptions:
    * Super globals (`$_SESSION`, `$_GET`, `$_POST`, etc.)
    * Static class members (`ISLE\[class]::[member]`, etc.)
* Documentation: PHPDoc (PSR-5)

## SQL
* https://docs.telemetry.mozilla.org/concepts/sql_style.html and all variables names enclosed in backticks
* Multiline query strings should start at column 2, with delimiters (start/end quotes) on separate lines
